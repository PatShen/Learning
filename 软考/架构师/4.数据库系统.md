```
SQL 语句
SELECT
GRANT
GROUP BY
```
上午：4'

# 数据库概述 1'
## 数据库模式
> 比较理想化，实际使用不多。纯概念考察

三级模式
* 内模式：文件级别（存储模式）
* 概念模式：表级别（逻辑模式）
* 外模式：视图级别（用户模式）

两级映射关系，分别保障了数据的独立性：
* 逻辑独立性
* 物理独立性

聚簇索引
* 会修改存储顺序，会影响内模式

## 分布式数据库
> 多个物理节点存放数据库（数据在多个物理节点存放）
>
> 副本，冗余提高，也提高可用性、数据持久性。
>
> 提高性能：多副本可读，就近读取

* 可用性：当一个节点故障，其他节点依旧可用。系统整体仍然可用
* 自治性：每个节点可以自己管理自己，具有局部数据库
* 共享性：节点之间共享数据
* 分布性：不同场地存储

* 全局概念模式：数据库的逻辑结构（也可以叫做全局逻辑模式）
* 全局外模式：应用程序直接调用的部分
* 分片模式
  * 水平分片：满足某筛选条件的数据，放在同一个物理节点上
  * 垂直分片：核心字段放在一个节点，其他字段放在其他节点
* 分布模式
  * 考虑把分片放到哪里
  * 副本机制
 
* 数据独立性
* 集中与自治共享结合的控制结构
* 适当增加数据冗余度
* 全局的一致性、可串性和可恢复性

### 透明性分类
> 透明性：用户不关心

* 分片透明：不关心数据分不分片、怎么分片
* 位置透明：不关心数据存放在何处（物理位置）
* 复制透明：不关心各个节点数据的复制与同步更新
* 逻辑透明：不关心局部DBMS支持哪种数据模型、使用哪种语言

> 用户不必关心数据是如何分块存储的：分片透明

```
考点：
1.分布式数据库的特点：分布性、可用性、自治性、共享性
2.分片方式
3.透明性分类
4.体系结构
```

### 两阶段提交协议 2PC

* 2PC事务提交的两个阶段
  * 表决阶段：形成共同的决定
  * 执行阶段，实现前一阶段的决定
* 两条全局提交规则
  * 只要有一个参与者撤销事务，协调者就必须做出`全局撤销`的决定
  * 只有所有参与者都同意提交事务，协调者才能做出`全局提交`的决定


# 数据库设计过程（阶段）1‘

> 考虑当前、未来应用的数据要求（需求），以及数据处理的要求

* 需求分析，产出：
  * 数据流图
  * 数据字典
  * 需求说明书
* 概念结构设计：产物会在后续步骤中使用，对现实世界进行抽象
  * E-R 模型：实体-关系模型（Entity-Relationship）
  * 用户的数据模型：是一种概念模型，与DBMS无关。
* 逻辑结构设计：根据E-R模型转换规则、规范化理论，产出：
  * 数据库表
  * 关系模式：可以直接转化为二维表
    * 例如：学生（姓名，性别，学号...），表名：学生；列名（字段）：姓名、性别、学号。
  * 输出：视图、完整性约束、应用处理说明书给后续步骤
* 物理设计：根据DBMS特性、硬件、OS特性等

## E-R 模型

> 两个实体集之间的关系，1:1，1:n，m:n

## 概念结构设计

集成方法：
* 多个E-R图一次集成
* 逐步集成

冲突&解决办法：
* 属性冲突：属性域冲突和属性取值冲突【同一对象】。协商统一
* 命名冲突：同名异义，异名同义【同一对象】。协商统一
* 结构冲突：同一对象在不同应用中具有不同的抽象；同一实体在不同局部E-R图中所包含的属性个数和排列次序不完全相同。个数不同，一般保留较多的，较少部分进行补充

步骤
* 抽象数据
* 设计局部ER模型
* 合并局部模型，消除冲突
* 重构优化，消除冗余

## 逻辑结构设计

步骤
* 转化为数据模型
* 关系规范化
* 模式优化
* 设计用户子模式

联系在转换时
* `1:1`：可以单独转换，也可以并入任意一端。
* `1:n`：可以单独转换，也可以并入多端
* `m:n`：只能单独转换

* 实体完整性约束：主键，唯一且非空
* 参照完整性约束：外键，要么为空，要么是其他关系的主键

### 关系模式
```
R<U,F>
U：属性集合
F：函数依赖集合
```

* 目或度：关系模式中属性的个数
* 候选码（候选键）：唯一标识元组，且无冗余。可以有多个。
  * 是属性集合，可以有1个或多个。
* 主码（主键）
* 主属性与非主属性：组成候选码的属性就是主属性，其他都是非主属性
* 外码（外键）
* 全码（all-key）：关系模式的所有属性组是这个关系的候选码
* 简单属性与复合属性、派生属性、多值属性
  * 复合属性：地址，拆分成省、市、街道...否则是简单属性
  * 派生属性：可由计算、推导得出的属性
  * 多值属性
 
# 重点
## 集中式数据库
* 三级模式，两级映射，对应：xxx
* 逻辑独立性，物理独立性
* 聚簇索引

## 分布式数据库
* 体系结构，层次划分
* 特点
* 透明性分类
* 分片方式
* 2PC

## 数据库设计
* 了解各个阶段的产物

## 概念结构设计过程
冲突

## 逻辑结构设计过程
完整性分类

## 关系模式的概念

# 关系代数 3'



# 规范化理论 3'
# 数据控制 1'

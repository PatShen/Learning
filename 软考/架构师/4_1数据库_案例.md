```
规范化与反规范化
索引与视图
分布式数据库
NoSQL
内存数据
```

# 数据库设计
## 逻辑数据模型设计过程
* 构建系统上下文数据模型，包含实体及实体之间的联系
* 绘制基于主键的数据模型，为每个实体添加主键属性
* 构建全属性数据模型，为每个实体添加非主键属性
* 利用规范化技术建立系统规范化数据模型

* 转化为数据模型
* 关系规范化
* 模式优化
* 设计用户子模式

## 数据库设计关注的问题
* 性能：查询/修改
  * 规范化（表格尽可能简洁，减少冗余）：查询慢，修改快。
  * 多查询，少修改：反规范化/索引/分布式数据库/读写分离
    * 通过增加数据冗余，提高查询效率（用空间换时间）。会带来数据一致性问题
* 数据一致性
  * 一次一起写：应用程序/数据库插件
  * 联动修改：触发器
  * 后续修改：批处理
* 安全

## 数据库的性能优化
* 集中式
  * 硬件：CPU，内存，I/O（硬盘、阵列），网络
  * 系统软件：参数，如进程优先级，CPU使用权，内存使用
  * 数据库设计
    * 分区、分表、分库
    * 物化视图：多查询，少修改
    * 索引：常查询——建索引，常修改——避免索引
    * SQL优化
      * 以不相干子查询代替相干子查询
      * 只检索需要的列
      * 用带IN的条件子句等价替换OR
      * 经常提交COMMIT，以尽早释放锁
      * 尽可能减少多表查询
  * 应用软件：数据库连接池（连接数据库时优化连接方式）
* 分布式：除了集中式之外的优化，还有：
  * 通信代价
    * 全局查询树的变换
    * 多副本策略
    * 查询树的分解
    * 半连接与直接连接
   
## 规范化与反规范化
* 规范化：细粒度；影响查询性能；根据业务场景反规范化
* 反规范化：连接操作少，检索快，统计快，需要查的表减少，检索容易
  * 方式
    * 增加派生冗余列
    * 增加其他冗余列
    * 重新组表
    * 分割表：把用户表做水平分割，例如按地域分割
  * 缺点
    * 数据冗余，需要更大的存储空间——无解
    * 插入、更新、删除操作开销大——无解
    * 数据不一致，可能产生添加、修改、删除异常——触发器同步；应用程序同步
    * 更新和插入代码编写难度高——无解
